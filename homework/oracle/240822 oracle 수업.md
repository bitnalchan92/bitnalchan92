## 17장 사용자 관리

3. **사용자에게 시스템 권한을 ① ______과 함께 부여하면 그 사용자는 데이터베이스 관리자가 아닌데도 불구하고 부여받은 시스템 권한을 다른 사용자에게 부여할 수 있는 권한도 함께 부여받게 됩니다.**

WITH ADMIN OPTION



4. **사용자에게 객체 권한을 ② ______과 함께 부여하면 그 사용자는 그 객체를 접근할 권한을 부여받으면서 그 권한을 다른 사용자에게 부여할 수 있는 권한도 함께 부여받게 됩니다.**

WITH GRANT OPTION



5. **테이블 스페이스(TABLESPACE)에 대해서 설명하시오.**

데이터베이스에서 데이터를 저장하는 논리적인 저장단위

테이블 스페이스는 디스크 공간을 소비하는 테이블과 뷰 그리고 그 밖의 다른 데이터 베이스 객체들이 저장되는 장소입니다.



6. **데이터베이스 보안을 위한 권한은 시스템 권한과 (______)으로 나뉩니다.**

객체권한



7. **사용자가 사용할 테이블 스페이스의 영역을 할당하기 위해서는 QUOTA절을 사용해야 합니다.**

O



8. **데이터베이스에 접속할 수 있는 권한은 무엇입니까?**   1
   1) CREATE SESSION 
   2) CREATE TABLE
   3) CREATE VIEW
   4) CREATE SEQUENCE



9. **사용자에게 시스템 권한을 부여하기 위한 명령어는 무엇인가?**   3
   1) SHOW
   1) CONN
   1) GRANT
   1) DROP



---



## 18장 데이터베이스 롤 권한 제어

1. **KBS라는 사용자를 생성(암호는 PASS)하고 기본적인 권한 부여를 하지 않으면 데이터베이스에 로그인이 불가능하므로 CONNECT와 RESOURCE 권한을 KBS 사용자에게 부여하시오.**

CREATE USER KBS IDENTIFIED BY PASS;
GRANT CONNECT, RESOURCE TO KBS;



2. **SCOTT.SQL의 쿼리문을 각각 설명하시오.**

```sql
-- TIGER가 비밀번호인 SCOTT유저에게 CONNECT(데이터베이스에 접속할 권한), RESOURCE(테이블, 인덱스 등 객체를 생성할 권한) 권한을 부여하고, 이 사용자가 사용하는 테이블스페이스의 크기 제한을 없애는것을 허용한다.
GRANT CONNECT, RESOURCE, UNLIMITED TABLESPACE TO SCOTT IDENTIFIED BY TIGER;

-- SCOTT유저의 기본 테이블스페이스를 USERS로 변경하고, 임시 테이블스페이스를 TEMP로 변경한다.
ALTER
USER SCOTT DEFAULT TABLESPACE USERS;
ALTER
USER SCOTT TEMPORARY TABLESPACE TEMP;

-- SCOTT 유저로 데이터베이스 접속
CONNECT SCOTT/TIGER

-- 새로 생성할 테이블 DEPT가 있음을 고려해 테이블 삭제 쿼리 수행
DROP TABLE DEPT;

-- PK_DEPT란 제약조건 이름을 가진 PK인 두자리 NUMBER타입인 컬럼 DEPTNO와
-- 각각 14자, 13자(바이트 확인필!)의 VARCHAR2 타입의 DNAME, LOC 컬럼을 가진
-- DEPT테이블을 생성
CREATE TABLE DEPT
(
    DEPTNO NUMBER(2) CONSTRAINT PK_DEPT PRIMARY KEY,
    DNAME  VARCHAR2(14),
    LOC    VARCHAR2(13)
);

-- 위와 동일한 이유로 EMP테이블 삭제 쿼리 수행
DROP TABLE EMP;

-- EMP 테이블 생성
CREATE TABLE EMP
(
    EMPNO    NUMBER(4) CONSTRAINT PK_EMP PRIMARY KEY, -- PK_EMP라는 제약조건 이름을 가지고, PK인 네자리의 NUMBER타입의 컬럼인 EMPNO
    ENAME    VARCHAR2(10),
    JOB      VARCHAR2(9),
    MGR      NUMBER(4),
    HIREDATE DATE, -- 날짜 타입의 HIREDATE
    SAL      NUMBER(7,2), -- 전체 7자리이고, 소수점 이하 2자리인 NUMBER타입의 컬럼인 SAL
    COMM     NUMBER(7,2), -- 전체 7자리이고, 소수점 이하 2자리인 NUMBER타입의 컬럼인 COMM
    DEPTNO   NUMBER(2) CONSTRAINT FK_DEPTNO REFERENCES DEPT -- DEPT테이블의 PK인 DEPTNO 컬럼을 참조하는 FK_DEPTNO라는 외래키제약조건 이름을 가진 두자리 NUMBER타입의 컬럼인 DEPTNO
);

-- 세개의 컬럼 타입에 알맞은 데이터를 DEPT 테이블에 삽입하는 쿼리 수행
INSERT INTO DEPT
VALUES (10, 'ACCOUNTING', 'NEW YORK');
INSERT INTO DEPT
VALUES (20, 'RESEARCH', 'DALLAS');
INSERT INTO DEPT
VALUES (30, 'SALES', 'CHICAGO');
INSERT INTO DEPT
VALUES (40, 'OPERATIONS', 'BOSTON');

-- 각각의 컬럼에 알맞은 데이터를 EMP테이블에 삽입하는 쿼리 수행
-- 날짜타입의 경우 formatting하여 insert
-- COMM 컬럼에 들어갈 값이 null인데 테이블 생성시 NOT NULL을 명시하지 않았기 때문에 null값 삽입이 허용
INSERT INTO EMP
VALUES (7369, 'SMITH', 'CLERK', 7902, to_date('17-12-1980', 'dd-mm-yyyy'), 800, NULL, 20);
INSERT INTO EMP
VALUES (7499, 'ALLEN', 'SALESMAN', 7698, to_date('20-2-1981', 'dd-mm-yyyy'), 1600, 300, 30);
INSERT INTO EMP
VALUES (7521, 'WARD', 'SALESMAN', 7698, to_date('22-2-1981', 'dd-mm-yyyy'), 1250, 500, 30);
INSERT INTO EMP
VALUES (7566, 'JONES', 'MANAGER', 7839, to_date('2-4-1981', 'dd-mm-yyyy'), 2975, NULL, 20);
INSERT INTO EMP
VALUES (7654, 'MARTIN', 'SALESMAN', 7698, to_date('28-9-1981', 'dd-mm-yyyy'), 1250, 1400, 30);
INSERT INTO EMP
VALUES (7698, 'BLAKE', 'MANAGER', 7839, to_date('1-5-1981', 'dd-mm-yyyy'), 2850, NULL, 30);
INSERT INTO EMP
VALUES (7782, 'CLARK', 'MANAGER', 7839, to_date('9-6-1981', 'dd-mm-yyyy'), 2450, NULL, 10);
INSERT INTO EMP
VALUES (7788, 'SCOTT', 'ANALYST', 7566, to_date('13-7-1987', 'dd-mm-yyyy'), 3000, NULL, 20);
INSERT INTO EMP
VALUES (7839, 'KING', 'PRESIDENT', NULL, to_date('17-11-1981', 'dd-mm-yyyy'), 5000, NULL, 10);
INSERT INTO EMP
VALUES (7844, 'TURNER', 'SALESMAN', 7698, to_date('8-9-1981', 'dd-mm-yyyy'), 1500, 0, 30);
INSERT INTO EMP
VALUES (7876, 'ADAMS', 'CLERK', 7788, to_date('13-7-1987', 'dd-mm-yyyy'), 1100, NULL, 20);
INSERT INTO EMP
VALUES (7900, 'JAMES', 'CLERK', 7698, to_date('3-12-1981', 'dd-mm-yyyy'), 950, NULL, 30);
INSERT INTO EMP
VALUES (7902, 'FORD', 'ANALYST', 7566, to_date('3-12-1981', 'dd-mm-yyyy'), 3000, NULL, 20);
INSERT INTO EMP
VALUES (7934, 'MILLER', 'CLERK', 7782, to_date('23-1-1982', 'dd-mm-yyyy'), 1300, NULL, 10);

-- BONUS 테이블이 있을수도 있으므로 미리 삭제 쿼리 수행
DROP TABLE BONUS;

-- BONUS 테이블 생성 쿼리 수행
CREATE TABLE BONUS
(
    ENAME VARCHAR2(10),
    JOB   VARCHAR2(9),
    SAL   NUMBER, -- 자리수 지정 없는 NUMBER타입
    COMM  NUMBER
);

-- SALGRADE 테이블이 있을수도 있으므로 미리 삭제 쿼리 수행
DROP TABLE SALGRADE;

-- SALGRADE 테이블 생성 쿼리 수행
CREATE TABLE SALGRADE
(
    GRADE NUMBER,
    LOSAL NUMBER,
    HISAL NUMBER
);

-- 각각의 컬럼 타입에 알맞은 데이터를 SALGRADE 테이블에 삽입하는 쿼리 수행
INSERT INTO SALGRADE
VALUES (1, 700, 1200);
INSERT INTO SALGRADE
VALUES (2, 1201, 1400);
INSERT INTO SALGRADE
VALUES (3, 1401, 2000);
INSERT INTO SALGRADE
VALUES (4, 2001, 3000);
INSERT INTO SALGRADE
VALUES (5, 3001, 9999);

-- 지금까지 작성한 모든 쿼리들을 영구적으로 데이터베이스에 반영하기 위해 커밋 명령어 수행
COMMIT;
```



---



## 19장. 동의어

1. 

**1.2 소유자인 scott을 지정하지 않으면 USERB1 소유자가 SCOTT의 EMP객체에 접근할 수 없습니다. SCOTT소유의 EMP테이블을 EMP란 이름의 동의어로 접근할 수 있도록 비공개동의어를 지정하시오.**

-- 1. scott계정으로 접속해서 USERB1에게 EMP테이블에 대한 SELECT 권한 부여
	CONN scott/tiger
	GRANT SELECT ON EMP TO USERB1;

-- 2. USERB1계정으로 접속해서 비공개동의어 만들기
	CONN USERB1/B1234
	CREATE SYNONYM EMP FOR scott.EMP;

​	

2. **USERB1과 USERB2에서 모두 사용할 수 있는 공개 동의어로 선언해 보시오.**

-- SYSTEM계정으로 공개동의어 생성
	CREATE PUBLIC SYNONYM EMP FOR scott.EMP;

-- scott계정에서 select권한 부여
	GRANT SELECT ON EMP TO USERB1, USERB2;



---



1. 

```sql
SET SERVEROUTPUT ON
DECLARE
    VEMP   EMP%ROWTYPE;
    ANNSAL NUMBER(7, 2);
BEGIN
    DBMS_OUTPUT.PUT_LINE(RPAD('EMPNO', 7) 
                         || RPAD('ENAME', 11) 
                         -- || RPAD('SAL', 11) 
                         -- || RPAD('COMM', 11) 
                         || RPAD('ANNSAL', 11));
                         
    DBMS_OUTPUT.PUT_LINE(RPAD('-', 50, '-'));

    SELECT *
    INTO VEMP
    FROM EMP
    WHERE ENAME = 'SCOTT';

    IF ( VEMP.COMM IS NULL ) THEN
        VEMP.COMM := 0;
    end if;

    ANNSAL := VEMP.SAL * 12 + VEMP.COMM;
    
    DBMS_OUTPUT.PUT_LINE(RPAD(VEMP.EMPNO, 7) 
                         || RPAD(VEMP.ENAME, 11) 
                         -- || RPAD(VEMP.SAL, 11) 
                         -- || RPAD(VEMP.COMM, 11) 
                         || RPAD(ANNSAL, 11));
END;
/
```
