## 04장. SELECT로 특정 데이터를 추출하기

9. EMP 테이블의 자료를 입사일을 오름차순으로 정렬하고 사원번호, 사원명, 직급, 입사일 칼럼을 출력하는 쿼리문을 작성하시오.

SELECT EMPNO, ENAME, JOB, HIREDATE
FROM EMP
ORDER BY HIREDATE;



10. EMP 테이블의 자료를 사원번호를 기준으로 내림차순으로 정렬하여 사원 번호와 사원명 칼럼을 표시하시오.

SELECT EMPNO, ENAME
FROM EMP
ORDER BY EMPNO DESC;



11. 부서 번호가 빠른 사원부터 출력하되 같은 부서내의 사원을 출력할 경우 최근에 입사한 사원부터 출력하도록 하세요.
    단, 사원 번호, 입사일, 사원 이름, 급여를 출력하시오.

SELECT EMPNO, HIREDATE, ENAME, SAL
FROM EMP
ORDER BY DEPTNO, HIREDATE DESC;



## 05장. SQL 주요 함수

1. 사번이 홀수인 사람들을 검색해 보십시오.

SELECT *
FROM EMP
WHERE MOD(EMPNO, 2) = 1
;



2. 다음과 같이 쿼리문을 구성하면 과연 직급이 'manager'인 사원을 검색할까요?

SELECT EMPNO, ENAME, JOB 
FROM EMP
WHERE JOB='manager'; => 선택된 레코드가 없음.

결론적으로 위와 같이 쿼리문을 기술하면 검색에 실패합니다. 왜냐하면 직 급 칼럼에 저장된 데이터는 모두 대문자 형태이기 때문입니다. 굳이 소문자 ('manager')로 데이터를 검색해야 한다면 LOWER 함수를 사용해서 원하는 결과를 얻을 수 있습니다.

굳이 소문자('manager')로 데이터를 검색해야 한다면 LOWER 함수를 사용 해서 원하는 결과를 얻을 수 있습니다. JOB 컬럼에 LOWER 함수를 적용하 여 JOB 컬럼에 저장된 값을 소문자로 변경한 후에 검색에 참여하도록 합니다.

SELECT EMPNO, ENAME, JOB
FROM EMP
WHERE (     ) ='manager';

=> LOWER(JOB)



3. 87년도에 입사한 직원을 알아내기 위해 SUBSTR 함수를 이용하여 HIREDATE 컬럼에서 첫 글자부터 2개를 추출하여 그 값이 87인지를 체크하 는 방법으로도 구해 보도록 하세요.

SELECT *
FROM EMP
WHERE SUBSTR(HIREDATE, 1, 2) = '87';



4. 다음은 이름이 E로 끝나는 사원을 검색해 보도록 합시다. SUBSTR 함수를 이용하여 ENAME 컬럼의 마지막 문자 한개만 추출해서 이름이 E로 끝나는 사원을 검색해 보도록 하시오.

   <힌트> 시작 위치를 -1로 주고 추출할 문자 개수를 1로 주면 됩니다.

SELECT *
FROM EMP
WHERE SUBSTR(ENAME, -1, 1) = 'E';



5. 이름의 세 번째 자리가 R인 사원을 검색하기 위해서 와일드카드 _ 와 LIKE 연산자 를 사용하여 다음과 같이 표현할 수 있습니다.

SQL> Select empno, ename from emp where ename like ‘__R%’;

결과화면)
 EMPNO ENAME

==

7521 WARD

7654 MARTIN 

7844 TURNER 

7902 FORD

위 쿼리문을 지금 배운 INSTR함수와 SUBSTR함수를 사용하여 작성해 보십시오.

SELECT *
FROM EMP
WHERE INSTR(ENAME, 'R', 3, 1) = 3;

SELECT *
FROM EMP
WHERE SUBSTR(ENAME, 3, 1) = 'R';



6. 각 사원들의 현재까지의 근무 일수를 구해봅시다.

SELECT ENAME, TRUNC(SYSDATE-HIREDATE) AS "근무일수"
FROM EMP;



7. 모든 사원은 자신의 상관(MANAGER)이 있다. 하지만 EMP 테이블에 유일하 게 상관이 없는 로우가 있는데 그 사원의 MGR 칼럼 값이 NULL이다. 상관 이 없는 사원만 출력하되 MGR 칼럼 값 NULL 대신 CEO로 출력해 봅시다
   단, NVL()를 사용해보세요.

SELECT EMPNO, ENAME, NVL(TO_CHAR(MGR), 'C E O') AS "MANAGER"
FROM EMP
WHERE MGR IS NULL;



8. 직급에 따라 급여를 인상하도록 하자. 직급이 'ANALYST'인 사원은 5%, 'SALESMAN'인 사원은 10%, 'MANAGER'인 사원은 15%, 'CLERK'인 사원 은 20%인 인상한다.

SELECT EMPNO, ENAME, JOB, SAL,
       DECODE(JOB,
           'ANALYST', SAL*1.05,
           'SALESMAN', SAL*1.1,
           'MANAGER', SAL*1.15,
           'CLERK', SAL*1.2,
           SAL
       ) AS "UPSAL"
FROM EMP;



9. 급여에 따라 다음과 같이 인상하도록 합니다.

   (CASE 사용) 급여가 1000미만이면 8%, 1000~2000 5%, 2001~3000 3%, 이외 1% 인상

SELECT ENAME, DEPTNO, SAL,
       CASE
           WHEN SAL < 1000 THEN SAL*1.08
           WHEN SAL <= 2000 THEN SAL*1.05
           WHEN SAL <= 3000 THEN SAL*1.03
           ELSE SAL*1.01
       END AS "UPSAL"
FROM EMP;



## 6장. 그룹 함수1

1. 가장 최근에 입사한 사원의 입사일과 입사한지 가장 오래된 사원의 입사일 을 출력하는 쿼리문을 작성하시오.

SELECT MAX(HIREDATE) AS "입사일", MIN(HIREDATE) AS "입사일"
FROM EMP;



2. 10번 부서 소속 사원중에서 커미션을 받는 사원의 수를 구해보시오.

SELECT COUNT(COMM) AS "사원수"
FROM EMP
GROUP BY DEPTNO
HAVING DEPTNO = 10;



3. 특정 칼럼을 기준으로 테이블에 존재하는 행들을 그룹별로 구분하기 위해 서는_______________사용합니다.

GROUP BY



4. GROUP BY 절에 특정 조건을 기술하기 위한 1 _____________________ 절을 사용합니다.

HAVING



## 문제 답

**-- 문제1**
SELECT TO_CHAR(HIREDATE, 'YY') as "년도", COUNT(*) as "입사자(명)"
FROM EMP
GROUP BY TO_CHAR(HIREDATE, 'YY');

**-- 문제2**
SELECT TO_CHAR(HIREDATE, 'YY') as "년도", COUNT(*) as "입사자(명)"
FROM EMP
GROUP BY TO_CHAR(HIREDATE, 'YY')
ORDER BY TO_CHAR(HIREDATE, 'YY') DESC; **-- ORDER BY "년도" DESC; 별칭을 이용해서도 정렬이 가능하다!**

**-- 문제3**
SELECT TO_CHAR(HIREDATE, 'YY/MM') as "년/월", COUNT(*) as "입사자(명)"
FROM EMP
GROUP BY TO_CHAR(HIREDATE, 'YY/MM')
ORDER BY  "년/월";

**-- 문제4**
SELECT TO_CHAR(HIREDATE, 'YY/MM') as "년/월", COUNT(*) as "입사자(명)"
FROM EMP
WHERE COMM IS NOT NULL
GROUP BY TO_CHAR(HIREDATE, 'YY/MM')
ORDER BY TO_CHAR(HIREDATE, 'YY/MM');

**-- 문제5**
SELECT TO_CHAR(HIREDATE, 'YY/MM') as "년/월", COUNT(*) as "입사자(명)", AVG(SAL) as "평균급여"
FROM EMP
GROUP BY TO_CHAR(HIREDATE, 'YY/MM')
ORDER BY TO_CHAR(HIREDATE, 'YY/MM');

**-- 문제6**
SELECT DEPTNO, COUNT(*)
FROM EMP
GROUP BY DEPTNO;

**-- 문제7**
SELECT DEPTNO, COUNT(*)
FROM EMP
GROUP BY DEPTNO
HAVING COUNT(*) < 5;

**-- 문제8**
SELECT MGR as "매니저번호", COUNT(*) as "인원수"
FROM EMP
GROUP BY MGR
ORDER BY MGR;

**-- 문제9**
SELECT MGR as "매니저번호", COUNT(*) as "인원수"
FROM EMP
WHERE MGR IS NOT NULL
GROUP BY MGR
ORDER BY MGR;

**-- 문제10**
SELECT MGR as "매니저번호", MAX(SAL) as "최고 급여"
FROM EMP
WHERE MGR IS NOT NULL
GROUP BY MGR
ORDER BY MGR;

**-- 문제11**
SELECT MGR as "매니저번호", MAX(SAL) as "최고 급여"
FROM EMP
WHERE MGR IS NOT NULL
GROUP BY MGR
HAVING MAX(SAL) BETWEEN 1000 AND 2000
ORDER BY MGR;