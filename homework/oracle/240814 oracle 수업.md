## 추가과제

SELECT ENAME,
       -- 이름 중에 두번째 알파벳부터 끝까지에 해당하는 문자열을 바꿀껀데 뭘로?
       -- *로, 길이 계산은 기존 이름의 길이 -1만큼을 잡아놓고, 첫번째 문자를 '*'로 잡아 나머지 또한 '*'로 채운다.
       REPLACE(ENAME, SUBSTR(ENAME,2), RPAD('*', LENGTH(ENAME)-1, '*')) AS REPLACE
FROM EMP;



## 6장. 그룹 함수2

1. **뉴욕에서 근무하는 사원의 이름과 급여를 출력하시오.**

SELECT E.ENAME, E.SAL
FROM EMP E,
     DEPT D
WHERE E.DEPTNO = D.DEPTNO
  AND D.LOC = 'NEW YORK';



SELECT E.ENAME, E.SAL
FROM EMP E
         INNER JOIN DEPT D ON E.DEPTNO = D.DEPTNO
WHERE D.LOC = 'NEW YORK';



2. **ACCOUNTING 부서 소속 사원의 이름과 입사일을 출력하시오.**

SELECT E.ENAME, E.SAL
FROM EMP E,
     DEPT D
WHERE E.DEPTNO = D.DEPTNO
  AND D.DNAME = 'ACCOUNTING';



SELECT E.ENAME, E.SAL
FROM EMP E
         INNER JOIN DEPT D ON E.DEPTNO = D.DEPTNO
WHERE D.DNAME = 'ACCOUNTING';



3. **직급이 MANAGER인 사원의 이름, 부서명을 출력하시오.**

SELECT E.ENAME, D.DNAME
FROM EMP E,
     DEPT D
WHERE E.DEPTNO = D.DEPTNO
  AND E.JOB = 'MANAGER';



SELECT E.ENAME, D.DNAME
FROM EMP E
         INNER JOIN DEPT D ON E.DEPTNO = D.DEPTNO
WHERE E.JOB = 'MANAGER';



4. **매니저가 KING인 사원들의 이름과 직급을 출력하시오.**

SELECT E.ENAME, E.JOB
FROM EMP E,
     EMP M
WHERE E.MGR = M.EMPNO
  AND M.ENAME = 'KING';



SELECT E.ENAME, E.JOB
FROM EMP E
         INNER JOIN EMP M ON E.MGR = M.EMPNO
WHERE M.ENAME = 'KING';



5. **SCOTT과 동일한 근무지에서 근무하는 사원의 이름을 출력하시오.**

SELECT E.ENAME, M.ENAME
FROM EMP E,
     EMP M
WHERE E.DEPTNO = M.DEPTNO
  AND M.ENAME <> 'SCOTT'
  AND E.ENAME = 'SCOTT';



SELECT E.ENAME, M.ENAME
FROM EMP E
         INNER JOIN EMP M ON E.DEPTNO = M.DEPTNO
WHERE M.ENAME <> 'SCOTT'
  AND E.ENAME = 'SCOTT';



6. **사원테이블과 부서 테이블을 조인하여 사원이름과 부서번호와 부서명을 출력하도록 합시다. 부서 테이블의 40번 부서와 조인할 사원테이블의 부서번호가 없지만, 아래 그림과 같이 40번 부서의 부서 이름도 출력되도록 쿼리문을 작성해 보시오.(힌트 : "(+)" 기호를 조인 조건에서 정보가 부족할수 있는 곳에 붙입니다.)**

SELECT E.ENAME, D.DEPTNO, D.DNAME
FROM EMP E,
     DEPT D
WHERE E.DEPTNO(+) = D.DEPTNO;



SELECT E.ENAME, D.DEPTNO, D.DNAME
FROM EMP E
         RIGHT OUTER JOIN DEPT D ON E.DEPTNO = D.DEPTNO;



7. **사원별 매니저 구하기를 RIGHT, LEFT, FULL OUTER JOIN을 이용해서 구해보세요.**

- **RIGHT OUTER JOIN**

​	SELECT E.ENAME 사원이름, M.ENAME 매니저이름
​	FROM EMP E
​         	RIGHT OUTER JOIN EMP M ON E.MGR = M.EMPNO
​	WHERE E.ENAME IS NOT NULL;

- **LEFT OUTER JOIN**

​	SELECT E.ENAME 사원이름, M.ENAME 매니저이름
​	FROM EMP E
​	         LEFT OUTER JOIN EMP M ON E.MGR = M.EMPNO
​	WHERE M.ENAME IS NOT NULL;

- **FULL OUTER JOIN**

​	SELECT E.ENAME 사원이름, M.ENAME 매니저이름
​	FROM EMP E
​	         FULL OUTER JOIN EMP M ON E.MGR = M.EMPNO
​	WHERE E.ENAME IS NOT NULL
​	  AND M.ENAME IS NOT NULL;



8. **사원테이블에 대한 급여 등급을 조회하는 문을 ANSI JOIN문으로 바꾸어 보세요.**

​	SELECT E.ENAME 사원명, E.SAL 급여, SG.GRADE 급여등급
​	FROM EMP E
​	         INNER JOIN SALGRADE SG ON E.SAL BETWEEN SG.LOSAL AND SG.HISAL;





1. **SCOTT과 같은 부서에서 근무하는 사원의 이름과 부서 번호를 출력하는 SQL문을 작성해 보시오.**

SELECT ENAME, DEPTNO
FROM EMP
WHERE DEPTNO = (SELECT DEPTNO
                FROM EMP
                WHERE ENAME = 'SCOTT');



2. **SCOTT와 동일한 업무(JOB)을 가진 사원을 출력하는 SQL문을 작성해 보시오.**

SELECT *
FROM EMP
WHERE JOB = (SELECT JOB
             FROM EMP
             WHERE ENAME = 'SCOTT');



3. **SCOTT의 급여와 동일하거나 더 많이 받는 사원 명과 급여를 출력하시오.**

SELECT ENAME, SAL
FROM EMP
WHERE SAL >= (SELECT SAL
              FROM EMP
              WHERE ENAME = 'SCOTT');



4. **DALLAS에서 근무하는 사원의 이름, 부서 번호를 출력하시오.**

SELECT ENAME, DEPTNO
FROM EMP
WHERE DEPTNO = (SELECT DEPTNO
                FROM DEPT
                WHERE LOC = 'DALLAS');



5. **SALES(영업부) 부서에서 근무하는 모든 사원의 이름과 급여를 출력하시오.**

SELECT ENAME, SAL
FROM EMP
WHERE DEPTNO = (SELECT DEPTNO
                FROM DEPT
                WHERE DNAME = 'SALES');



6. **직속상관이 KING인 사원의 이름과 급여를 출력하시오.**

SELECT ENAME, SAL
FROM EMP
WHERE MGR = (SELECT EMPNO
             FROM EMP
             WHERE ENAME = 'KING');



7. **직급(JOB)이 MANAGER인 사람이 속한 부서의 부서 번호와 부서명과 지역을 출력하시오.**

SELECT DEPTNO, DNAME, LOC
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO
                 FROM EMP
                 WHERE JOB = 'MANAGER');